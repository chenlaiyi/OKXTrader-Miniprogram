<!--pages/index/index.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨åŒºåŸŸ -->
  <view class="header">
    <view class="title">OKXTrader</view>
    <view class="subtitle">æ™ºèƒ½åŠ å¯†è´§å¸äº¤æ˜“åŠ©æ‰‹</view>
  </view>

  <!-- è¡Œæƒ…æ¦‚è§ˆå¡ç‰‡ -->
  <view class="section">
    <view class="section-title">ğŸ“ˆ çƒ­é—¨è¡Œæƒ…</view>
    <scroll-view scroll-x class="market-scroll" enable-flex show-scrollbar="{{false}}">
      <view class="market-card" wx:for="{{markets}}" wx:key="inst_id" bindtap="goToMarket" data-symbol="{{item.inst_id}}">
        <view class="symbol">{{item.inst_id}}</view>
        <view class="price" style="color: {{item.color}}">
          {{item.price}}
        </view>
        <view class="change" style="color: {{item.color}}">
          {{item.change}}
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ -->
  <view class="section">
    <view class="section-title">âš¡ å¿«é€Ÿæ“ä½œ</view>
    <view class="quick-actions">
      <view class="action-item" bindtap="goToTrading">
        <view class="action-icon">ğŸ“Š</view>
        <view class="action-text">äº¤æ˜“</view>
      </view>
      <view class="action-item" bindtap="goToMarket">
        <view class="action-icon">ğŸ“ˆ</view>
        <view class="action-text">è¡Œæƒ…</view>
      </view>
      <view class="action-item" bindtap="goToStrategy">
        <view class="action-icon">âš™ï¸</view>
        <view class="action-text">ç­–ç•¥</view>
      </view>
      <view class="action-item" bindtap="goToAI">
        <view class="action-icon">ğŸ¤–</view>
        <view class="action-text">AIåˆ†æ</view>
      </view>
    </view>
  </view>

  <!-- AIåˆ†æé¢„è§ˆ -->
  <view class="section" wx:if="{{aiAnalysis}}">
    <view class="section-title">ğŸ¤– AIåˆ†æå»ºè®®</view>
    <view class="ai-card">
      <view class="ai-header">
        <view class="ai-signal {{aiAnalysis.signal_type === 'long' ? 'long' : 'short'}}">
          {{aiAnalysis.signal_type === 'long' ? 'ğŸ“ˆ åšå¤šå»ºè®®' : 'ğŸ“‰ åšç©ºå»ºè®®'}}
        </view>
        <view class="ai-confidence">ç½®ä¿¡åº¦ {{aiAnalysis.confidence}}%</view>
      </view>
      <view class="ai-reasoning">{{aiAnalysis.reasoning}}</view>
      <view class="ai-footer">
        <view class="time">{{formatTime(aiAnalysis.timestamp)}}</view>
        <view class="detail-link" bindtap="goToAI">æŸ¥çœ‹è¯¦æƒ… â†’</view>
      </view>
    </view>
  </view>

  <!-- æŒä»“æ¦‚è§ˆ -->
  <view class="section" wx:if="{{positions.length > 0}}">
    <view class="section-title">ğŸ’¼ å½“å‰æŒä»“</view>
    <view class="position-list">
      <view class="position-item" wx:for="{{positions}}" wx:key="id" bindtap="viewPosition" data-id="{{item.id}}">
        <view class="pos-header">
          <view class="pos-symbol">{{item.symbol}}</view>
          <view class="pos-side {{item.side}}">{{item.side === 'long' ? 'åšå¤š' : 'åšç©º'}}</view>
        </view>
        <view class="pos-info">
          <view class="pos-price">å…¥åœº: {{item.entryPrice}}</view>
          <view class="pos-pnl" style="color: {{item.unrealizedPnl >= 0 ? '#00c853' : '#ff5252'}}">
            {{item.unrealizedPnl >= 0 ? '+' : ''}}{{item.unrealizedPnl}}
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- è‡ªåŠ¨äº¤æ˜“çŠ¶æ€ -->
  <view class="section">
    <view class="section-title">ğŸ”„ è‡ªåŠ¨äº¤æ˜“</view>
    <view class="auto-trade-card">
      <view class="auto-info">
        <view class="auto-status {{autoTradingEnabled ? 'enabled' : 'disabled'}}">
          {{autoTradingEnabled ? 'âœ… å·²å¯ç”¨' : 'âŒ å·²ç¦ç”¨'}}
        </view>
        <view class="auto-desc">AIç­–ç•¥è‡ªåŠ¨æ‰§è¡Œäº¤æ˜“</view>
      </view>
      <switch checked="{{autoTradingEnabled}}" bindchange="toggleAutoTrading" color="#667eea"/>
    </view>
  </view>

  <!-- åº•éƒ¨è¯´æ˜ -->
  <view class="footer">
    <view class="footer-text">OKXTraderå°ç¨‹åº v1.0.0</view>
    <view class="footer-text">æ•°æ®æ¥æºäºOKXå…¬å¼€API</view>
  </view>
</view>
