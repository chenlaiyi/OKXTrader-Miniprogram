<!--pages/ai/ai.wxml-->
<view class="container">
  <!-- æ ‡é¢˜æ  -->
  <view class="header">
    <view class="header-left">
      <text class="header-icon">ğŸ§ </text>
      <text class="title">AI åˆ†æ</text>
    </view>
    <view class="header-right">
      <switch checked="{{autoTradeEnabled}}" bindchange="toggleAutoTrade" color="#af52de" class="auto-switch"/>
      <text class="switch-label">è‡ªåŠ¨äº¤æ˜“</text>
    </view>
  </view>

  <!-- ç­–ç•¥çŠ¶æ€ -->
  <view class="strategy-section">
    <view class="strategy-header">
      <text class="strategy-title">{{strategyName}}</text>
      <text class="strategy-timeframe">({{strategyTimeframe}})</text>
    </view>
    <view class="strategy-status">
      <text class="status-label">è¿è¡ŒçŠ¶æ€</text>
      <text class="status-value {{autoTradeEnabled ? 'enabled' : 'disabled'}}">{{autoTradeEnabled ? 'è¿è¡Œä¸­' : 'å·²åœæ­¢'}}</text>
    </view>
  </view>

  <!-- æœ€æ–°åˆ†æ -->
  <view class="analysis-section">
    <view class="section-header">
      <text class="section-title">æœ€æ–°åˆ†æ</text>
      <text class="section-time">{{analysisTime}}</text>
    </view>

    <view class="analysis-card" wx:if="{{latestAnalysis}}">
      <view class="analysis-signal">
        <view class="signal-badge {{latestAnalysis.signal_type}}">
          <text class="signal-text">{{latestAnalysis.signal_type === 'long' ? 'åšå¤šä¿¡å·' : latestAnalysis.signal_type === 'short' ? 'åšç©ºä¿¡å·' : 'è§‚æœ›ä¿¡å·'}}</text>
        </view>
        <view class="confidence-badge">
          <text class="confidence-value">{{latestAnalysis.confidence}}</text>
          <text class="confidence-unit">%</text>
        </view>
      </view>

      <view class="divider"></view>

      <view class="analysis-reasoning">
        <text class="reasoning-label">åˆ†æç†ç”±</text>
        <text class="reasoning-text">{{latestAnalysis.reasoning}}</text>
      </view>

      <view class="divider" wx:if="{{latestAnalysis.risks && latestAnalysis.risks.length > 0}}"></view>

      <view class="analysis-risks" wx:if="{{latestAnalysis.risks && latestAnalysis.risks.length > 0}}">
        <text class="risks-label">é£é™©æç¤º</text>
        <view class="risks-list">
          <view class="risk-item" wx:for="{{latestAnalysis.risks}}" wx:key="index">
            <text class="risk-text">{{item}}</text>
          </view>
        </view>
      </view>
    </view>

    <view class="analysis-empty" wx:else>
      <text class="empty-text">æš‚æ— AIåˆ†æ</text>
    </view>
  </view>

  <!-- å†å²åˆ†æ -->
  <view class="history-section">
    <view class="section-header">
      <text class="section-title">å†å²åˆ†æ</text>
      <text class="section-count">{{historyCount}}</text>
    </view>

    <scroll-view class="history-list" scroll-y>
      <view class="history-item" wx:for="{{historyList}}" wx:key="id">
        <view class="history-left">
          <text class="history-symbol">{{item.symbol}}</text>
          <text class="history-time">{{item.time}}</text>
        </view>
        <view class="history-right">
          <view class="history-signal {{item.signal_type}}">
            <text class="signal-mini">{{item.signal_type === 'long' ? 'å¤š' : item.signal_type === 'short' ? 'ç©º' : 'è§‚'}}</text>
          </view>
          <text class="history-confidence">{{item.confidence}}%</text>
        </view>
      </view>
    </scroll-view>
  </view>
</view>
