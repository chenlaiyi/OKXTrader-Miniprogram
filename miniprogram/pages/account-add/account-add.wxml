<!-- 添加OKX账号页面 -->
<view class="container">
  <!-- 顶部导航栏 -->
  <view class="nav-bar">
    <text class="cancel-btn" bindtap="onCancel">取消</text>
    <text class="title">{{isEdit ? '编辑账号' : '添加OKX账号'}}</text>
    <text class="save-btn" bindtap="onSave">保存</text>
  </view>

  <!-- 表单区域 -->
  <scroll-view class="form-scroll" scroll-y>
    <view class="form-section">
      <!-- 快捷操作按钮 -->
      <view class="quick-actions" wx:if="{{!isEdit}}">
        <button class="quick-btn scan" bindtap="onScanQRCode">
          <text class="btn-icon">📱</text>
          <text class="btn-text">扫描二维码</text>
        </button>
        <button class="quick-btn paste" bindtap="onPasteFromClipboard">
          <text class="btn-icon">📋</text>
          <text class="btn-text">从剪贴板粘贴</text>
        </button>
      </view>

      <!-- 账号名称 -->
      <view class="form-item">
        <text class="label">账号名称 *</text>
        <input
          class="input"
          placeholder="例如：我的OKX账号"
          value="{{accountName}}"
          bindinput="onAccountNameInput"
          maxlength="20"
        />
      </view>

      <view class="edit-tip" wx:if="{{isEdit}}">
        <text class="edit-tip-text">编辑仅支持名称与标签修改，如需更换API请重新添加账号。</text>
      </view>

      <!-- 标签 -->
      <view class="form-item">
        <text class="label">标签</text>
        <input
          class="input"
          placeholder="可选，例如：主账号、测试账号"
          value="{{label}}"
          bindinput="onLabelInput"
          maxlength="20"
        />
      </view>

      <view wx:if="{{!isEdit}}">
        <!-- API Key -->
        <view class="form-item">
          <view class="label-row">
            <text class="label">API Key *</text>
            <text class="paste-link" bindtap="onPasteApiKey">粘贴</text>
          </view>
          <input
            class="input"
            placeholder="请输入API Key或使用快捷操作"
            value="{{apiKey}}"
            bindinput="onApiKeyInput"
          />
        </view>

        <!-- Secret Key -->
        <view class="form-item">
          <view class="label-row">
            <text class="label">Secret Key *</text>
            <text class="paste-link" bindtap="onPasteSecretKey">粘贴</text>
          </view>
          <input
            class="input"
            placeholder="请输入Secret Key或使用快捷操作"
            value="{{secretKey}}"
            bindinput="onSecretKeyInput"
          />
        </view>

        <!-- Passphrase -->
        <view class="form-item">
          <view class="label-row">
            <text class="label">Passphrase *</text>
            <text class="paste-link" bindtap="onPastePassphrase">粘贴</text>
          </view>
          <input
            class="input"
            placeholder="请输入Passphrase或使用快捷操作"
            value="{{passphrase}}"
            bindinput="onPassphraseInput"
          />
        </view>
      </view>

      <!-- 说明 -->
      <view class="tips-section" wx:if="{{!isEdit}}">
        <view class="tip-title">💡 重要提示</view>
        <view class="tip-item">
          <text class="dot">•</text>
          <text class="tip-text">API参数将被加密存储，请确保在安全环境下输入</text>
        </view>
        <view class="tip-item">
          <text class="dot">•</text>
          <text class="tip-text">API权限至少需要交易权限，建议只开通必要权限</text>
        </view>
        <view class="tip-item">
          <text class="dot">•</text>
          <text class="tip-text">使用快捷粘贴功能时，请确保剪贴板包含完整的API信息</text>
        </view>
      </view>

      <!-- 如何获取API参数 -->
      <view class="guide-section">
        <view class="guide-title" bindtap="toggleGuide">
          <text>📖 如何获取API参数？</text>
          <text class="toggle-icon">{{showGuide ? '▲' : '▼'}}</text>
        </view>
        <view class="guide-content" wx:if="{{showGuide}}">
          <view class="guide-step">
            <text class="step-number">1</text>
            <text class="step-text">登录OKX官网 (okx.com)，进入 "API管理" 页面</text>
          </view>
          <view class="guide-step">
            <text class="step-number">2</text>
            <text class="step-text">创建API Key，设置名称，并创建Passphrase（请务必保存）</text>
          </view>
          <view class="guide-step">
            <text class="step-number">3</text>
            <text class="step-text">选择权限："读取" + "交易"（不要开启"提币"权限）</text>
          </view>
          <view class="guide-step">
            <text class="step-number">4</text>
            <text class="step-text">绑定IP地址（推荐）或选择不绑定</text>
          </view>
          <view class="guide-step">
            <text class="step-number">5</text>
            <text class="step-text">确认后，复制 API Key、Secret Key 和你创建的Passphrase</text>
          </view>
          <view class="guide-step highlight">
            <text class="step-number">⚡</text>
            <text class="step-text">快捷方式：在OKX后台全选复制，然后点击本页面的"从剪贴板粘贴"按钮</text>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>
</view>
