<!--pages/trading/trading.wxml-->
<view class="container">
  <!-- 当前交易对信息 -->
  <view class="pair-info">
    <view class="pair-header">
      <text class="pair-title">{{currentSymbol}}</text>
      <view class="price-section">
        <text class="current-price {{priceTrend}}">{{currentPrice}}</text>
        <view class="price-change">
          <text class="change-value {{priceTrend}}">{{priceChange}}</text>
          <text class="change-percent {{priceTrend}}">({{priceChangePercent}}%)</text>
        </view>
      </view>
    </view>

    <view class="divider"></view>

    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-label">24h 最高</text>
        <text class="stat-value">{{high24h}}</text>
      </view>
      <view class="stat-item">
        <text class="stat-label">24h 最低</text>
        <text class="stat-value">{{low24h}}</text>
      </view>
      <view class="stat-item">
        <text class="stat-label">24h 成交量</text>
        <text class="stat-value">{{volume24h}}</text>
      </view>
    </view>
  </view>

  <!-- 技术指标 -->
  <view class="indicators-section">
    <view class="section-header">
      <text class="section-title">技术指标</text>
      <button class="refresh-btn" bindtap="refreshIndicators">
        <text class="refresh-icon">↻</text>
      </button>
    </view>

    <view class="indicator-card">
      <view class="indicator-header">
        <text class="indicator-title">趋势</text>
      </view>
      <view class="indicator-body">
        <view class="ma-grid">
          <view class="ma-item">
            <text class="ma-label">MA</text>
            <text class="ma-value {{maTrend}}">{{maValue}}</text>
          </view>
        </view>
      </view>
    </view>

    <view class="indicator-card">
      <view class="indicator-header">
        <text class="indicator-title">动量</text>
      </view>
      <view class="indicator-body">
        <view class="rsi-row">
          <text class="rsi-label">RSI</text>
          <view class="rsi-bar">
            <view class="rsi-fill" style="width: {{rsiValue}}%"></view>
          </view>
          <text class="rsi-value">{{rsiValue}}</text>
        </view>
      </view>
    </view>

    <view class="indicator-card">
      <view class="indicator-header">
        <text class="indicator-title">波动</text>
      </view>
      <view class="indicator-body">
        <view class="bb-row">
          <view class="bb-item">
            <text class="bb-label">上轨</text>
            <text class="bb-value">{{bbUpper}}</text>
          </view>
          <view class="bb-item">
            <text class="bb-label">中轨</text>
            <text class="bb-value">{{bbMiddle}}</text>
          </view>
          <view class="bb-item">
            <text class="bb-label">下轨</text>
            <text class="bb-value">{{bbLower}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- AI分析 -->
  <view class="ai-section">
    <view class="section-header">
      <text class="section-title">AI 分析</text>
    </view>

    <view class="ai-card" wx:if="{{latestAnalysis}}">
      <view class="ai-header">
        <view class="signal-badge {{latestAnalysis.signal_type}}">
          <text class="signal-text">{{latestAnalysis.signal_type === 'long' ? '做多' : latestAnalysis.signal_type === 'short' ? '做空' : '观望'}}</text>
        </view>
        <view class="confidence-badge">
          <text class="confidence-text">置信度 {{latestAnalysis.confidence}}%</text>
        </view>
      </view>

      <view class="divider"></view>

      <view class="ai-body">
        <text class="ai-reasoning">{{latestAnalysis.reasoning}}</text>
      </view>
    </view>

    <view class="ai-empty" wx:else>
      <text class="empty-text">暂无AI分析</text>
    </view>
  </view>
</view>
